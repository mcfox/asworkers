.content-wrapper
  .content-header.row
    .content-header-left.col-md-6.col-12.mb-2
      %h3.content-header-title.mb-0
        = WorkManager.model_name.human
        = @work_manager.name
    .content-header-right.text-md-right.col-md-6.col-12
      .btn-group
        = link_to application_path(@application), class: 'btn btn-sm btn-secondary' do
          = Application.model_name.human
          = @application.name
  .content-body
    %section.row
      .col-md-6.col-lg-4
        = render 'item'
      .col-md-6.col-lg-8
        .card
          .card-header
            %h3 Monitoramento
          .card-contents
            = line_chart(@data, id: :workers_monit)

        = render 'last_cycles', application: @application, work_manager: @work_manager, cycles: @work_manager.cycles



:javascript
  $(document).ready(function() {
    var chart_data = [{ name: 'workers', data: [] } , {name: 'jobs', data: [] }];
    var g = Chartkick.charts["workers_monit"]
    var url = "#{chart_data_application_work_manager_path(format: :json)}"

    function update_chart(){
      $.get( url, function( data ) {
        // alert(chart_data);
        chart_data[0]['data'].push(data[0]);
        chart_data[1]['data'].push(data[1]);
        g.updateData(chart_data);
      });
    }
    update_chart();
    window.intervalId = setInterval(update_chart, 30000);
    }
  );